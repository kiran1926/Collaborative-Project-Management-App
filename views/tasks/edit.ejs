<!-- views/createTask.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <!-- Bootstrap CSS -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Create Task</title>
</head>
<body>
    <%- include("../partials/_navbar.ejs") %>
    <h2>Edit Task: <%= task.title %></h2>
    <form action="/users/<%= user._id %>/projects/<%= project._id%>/tasks/<%= task._id%>?_method=PUT" method="POST">
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" value="<%= task.title %>" required><br><br>

        <label for="description">Description:</label>
        <textarea id="description" name="description" ><%= task.description %></textarea><br><br>

        <label for="priority">Priority:</label>
        <select id="priority" name="priority" required>
            <option value="Low" <%= task.priority === "Low" ? "selected" : "" %>>Low</option>
            <option value="Medium"<%= task.priority === "Medium" ? "selected" : "" %>>Medium</option>
            <option value="High"<%= task.priority === "High" ? "selected" : "" %>>High</option>
        </select><br><br>

        <label for="dueDate">Due Date:</label>
        <input type="date" id="dueDate" name="dueDate" value="<%= task.dueDate ? task.dueDate.toISOString().split('T')[0] : '' %>"><br><br>

        <label for="assignedTo">Assigned To:</label>
       <select name="assignedTo" id="assignedTo">
        <% users.forEach( user => { %>
            <option value="<%= user._id %>"
                <% if (task.assignedTo && task.assignedTo._id.toString() === user._id.toString()) { %>
                    selected
                    <% } %>>
                <%= user.name %>
            </option>
            <% }) %>
       </select>

        <button type="submit">Update Task</button>
    </form>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>